load("C:/Users/connorb5/Desktop/GitHub/cbp_wsm/evap/EvapData.RData")
library(rgeos)
library(rgdal)
library(raster)
########Pan Evaporation Data########
setwd(paste0(my.filepath,'ReferenceET/'))
test<-raster("AprReferenceET.tif")
test<-projectRaster(test,crs=proj4string(BB))
testclip<-mask(test,BB)
plot(VA)
plot(testclip,add=T)
plot(VA,add=T)
plot(BB,add=T)
plot(testclip)
plot(BB,add=T)
plot(VA,add=T)
WB@data$AprRefET<-extract(testclip,WBCenter)
min(WB@data$AprRefET)
files<-list.files()
files<-files[grep('.tiff',files)]
files<-list.files()
files<-files[grep('.tif',files)]
i=4
month.abb[as.numeric(m[i])]
files<-files[grep(month.abb[as.numeric(m[i])],files)]
i=3
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
i=2
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
i=1
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
i=11
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
i=12
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
########Pan Evaporation Data########
setwd(paste0(my.filepath,'ReferenceET/'))
for (i in 1:length(m)){
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
if(length(files)>0){
lab<-paste0(month.abb[as.numeric(m[i])],"ReferenceET.tif")
test<-raster(lab)
test<-projectRaster(test,crs=proj4string(BB))
testclip<-mask(test,BB)
assign(paste0('RefET_',m[i]),testclip)
}
}
print(paste0("Checking month ",i," of ",length(m)))
for (i in 1:length(m)){
print(paste0("Checking month ",i," of ",length(m)))
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
if(length(files)>0){
lab<-paste0(month.abb[as.numeric(m[i])],"ReferenceET.tif")
test<-raster(lab)
test<-projectRaster(test,crs=proj4string(BB))
testclip<-mask(test,BB)
assign(paste0('RefET_',m[i]),testclip)
}
}
plot(RefET_04)
plot(RefET_05)
plot(RefET_06)
plot(RefET_07)
plot(RefET_08)
plot(RefET_09)
plot(RefET_10)
PanCoeff<-raster('PanCoefficient.tif')
PanCoeff<-projectRaster(PanCoeff,crs=proj4string(BB))
PanCoeff<-mask(PanCoeff,BB)
plot(PanCoeff)
WB@data$PanCoeff<-extract(PanCoeff,WBCenter)
WB@data$AprRefET<-extract(RefET_04,WBCenter)
WB@data$MayRefET<-extract(RefET_05,WBCenter)
WB@data$JunRefET<-extract(RefET_06,WBCenter)
WB@data$JulRefET<-extract(RefET_07,WBCenter)
WB@data$AugRefET<-extract(RefET_08,WBCenter)
WB@data$SepRefET<-extract(RefET_09,WBCenter)
WB@data$OctRefET<-extract(RefET_10,WBCenter)
min(WB@data$PanCoeff)
min(WB@data$AprRefET)
min(WB@data$MayRefET)
min(WB@data$JunRefET)
min(WB@data$JulRefET)
min(WB@data$AugRefET)
min(WB@data$SepRefET)
min(WB@data$OctRefET)
sum(is.na(WB@data$PanCoeff))
WB@data$COMID[is.na(WB@data$PanCoeff)]
WB@data$FID[is.na(WB@data$PanCoeff)]
WB@data$PanCoeff[WB@data$FID==39447]
WB@data$PanCoeff[WB@data$FID==47772]
#Pan Coefficient raster is too small. Two waterbody centroids are outside its bounds. Below are the manual inputs:
WB@data$PanCoeff[WB@data$FID==39447]<-0.78
WB@data$PanCoeff[WB@data$FID==47772]<-0.78
sum(is.na(WB@data$PanCoeff))
min(WB@data$PanCoeff)
sum(WB@data$AprRefET*WB@data$PanCoeff)
plot(PanCoeff*10)
i
dyinmo[i]
dyinmo<-c(31,28,31,30,31,30,31,31,30,31,30,31)
dyinmo[i]
########Pan Evaporation Data########
setwd(paste0(my.filepath,'ReferenceET/'))
for (i in 1:length(m)){
print(paste0("Checking month ",i," of ",length(m)))
files<-list.files()
files<-files[grep(month.abb[as.numeric(m[i])],files)]
if(length(files)>0){
lab<-paste0(month.abb[as.numeric(m[i])],"ReferenceET.tif")
test<-raster(lab)
test<-test*25.4/dyinmo[i]
test<-projectRaster(test,crs=proj4string(BB))
testclip<-mask(test,BB)
assign(paste0('RefET_',m[i]),testclip)
}
}
WB@data$PanCoeff<-extract(PanCoeff,WBCenter)
WB@data$AprRefET<-extract(RefET_04,WBCenter)
WB@data$MayRefET<-extract(RefET_05,WBCenter)
WB@data$JunRefET<-extract(RefET_06,WBCenter)
WB@data$JulRefET<-extract(RefET_07,WBCenter)
WB@data$AugRefET<-extract(RefET_08,WBCenter)
WB@data$SepRefET<-extract(RefET_09,WBCenter)
WB@data$OctRefET<-extract(RefET_10,WBCenter)
#Pan Coefficient raster is too small. Two waterbody centroids are outside its bounds. Below are the manual inputs:
WB@data$PanCoeff[WB@data$FID==39447]<-0.78
WB@data$PanCoeff[WB@data$FID==47772]<-0.78
sum(WB@data$AreaRcalc*(WB@data$AprRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
sum(WB@data$AreaRcalc*(WB@data$MayRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
sum(WB@data$AreaRcalc*(WB@data$JunRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
sum(WB@data$AreaRcalc*(WB@data$JulRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
sum(WB@data$AreaRcalc*(WB@data$AugRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
sum(WB@data$AreaRcalc*(WB@data$SepRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
sum(WB@data$AreaRcalc*(WB@data$OctRefET*WB@data$PanCoeff/1000)*264.1721/1000000000)
write.csv(WB@data,"C:/Users/connorb5/Desktop/WBData.csv")
rm(test)
rm(testclip)
save.image("C:/Users/connorb5/Desktop/GitHub/cbp_wsm/evap/EvapData.RData")
save.image("G:/My Drive/HARP/impoundment_evap_HARP-2016/EvapData.RData")
# par(mar=c(5,6,2,4))
# plot(ET,type='l',lwd=2,ylab='Mean Thornthwaite PET (mm/day)',xlab='Month',cex.lab=2,cex.axis=2)
#
# # HARGREAVES AND THORNTHWAITE
# ET<-c(mean(WB@data$JanHarg),mean(WB@data$FebHarg),mean(WB@data$MarHarg),mean(WB@data$AprHarg),mean(WB@data$MayHarg),mean(WB@data$JunHarg),mean(WB@data$JulHarg),mean(WB@data$AugHarg),mean(WB@data$SepHarg),mean(WB@data$OctHarg),mean(WB@data$NovHarg),mean(WB@data$DecHarg))
# ET2<-c(mean(WB@data$JanThorn),mean(WB@data$FebThorn),mean(WB@data$MarThorn),mean(WB@data$AprThorn),mean(WB@data$MayThorn),mean(WB@data$JunThorn),mean(WB@data$JulThorn),mean(WB@data$AugThorn),mean(WB@data$SepThorn),mean(WB@data$OctThorn),mean(WB@data$NovThorn),mean(WB@data$DecThorn))
# par(mar=c(5,6,2,4))
# plot(ET,type='l',lwd=2,ylab='Mean PET (mm/day)',xlab='Month',cex.lab=2,cex.axis=2,col='red')
# lines(ET2,col='blue',lwd=2)
# legend(x=1,y=6,bty='n',col=c('red','blue'),legend=c("Hargreaves","Thornthwaite"),lwd=2,cex=2,y.intersp = 0.75)
summer<-data.frame(Month=month.abb[4:10],Hargreaves=NA,Thornthwaite=NA,Hamon=NA,Pan=NA)
i=1
summer$Month[i]
summer$Month<-as.character(summer$Month)
summer$Month[i]
grep(colnames(WB@data),summer$Month[i])
colnames(WB@data)
grep(summer$Month[i],colnames(WB@data))
colnames(WB@data)[grep(summer$Month[i],colnames(WB@data))]
colnames(WB@data)[grep(paste0(summer$Month[i],'Harg'),colnames(WB@data))]
subst<-grep(paste0(summer$Month[i],'Harg'),colnames(WB@data))
subst<-WB@data[,subst]
for (i in 1:length(summer$Month)){
subst<-grep(paste0(summer$Month[i],'Harg'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Hargreaves[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'Thorn'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Hargreaves[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'Ham'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Hargreaves[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'RefET'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Pan[i]<-WB@data$AreaRcalc*(subst*WB@data$PanCoeff/1000)*264.1721/1000000000
}
View(summer)
i
summer$Month[i]
grep(paste0(summer$Month[i],'RefET'),colnames(WB@data))
grep(paste0(summer$Month[i],'Ham'),colnames(WB@data))
subst<-grep(paste0(summer$Month[i],'Ham'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Hamon[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'RefET'),colnames(WB@data))
subst<-WB@data[,subst]
# par(mar=c(5,6,2,4))
# plot(ET,type='l',lwd=2,ylab='Mean Thornthwaite PET (mm/day)',xlab='Month',cex.lab=2,cex.axis=2)
#
# # HARGREAVES AND THORNTHWAITE
# ET<-c(mean(WB@data$JanHarg),mean(WB@data$FebHarg),mean(WB@data$MarHarg),mean(WB@data$AprHarg),mean(WB@data$MayHarg),mean(WB@data$JunHarg),mean(WB@data$JulHarg),mean(WB@data$AugHarg),mean(WB@data$SepHarg),mean(WB@data$OctHarg),mean(WB@data$NovHarg),mean(WB@data$DecHarg))
# ET2<-c(mean(WB@data$JanThorn),mean(WB@data$FebThorn),mean(WB@data$MarThorn),mean(WB@data$AprThorn),mean(WB@data$MayThorn),mean(WB@data$JunThorn),mean(WB@data$JulThorn),mean(WB@data$AugThorn),mean(WB@data$SepThorn),mean(WB@data$OctThorn),mean(WB@data$NovThorn),mean(WB@data$DecThorn))
# par(mar=c(5,6,2,4))
# plot(ET,type='l',lwd=2,ylab='Mean PET (mm/day)',xlab='Month',cex.lab=2,cex.axis=2,col='red')
# lines(ET2,col='blue',lwd=2)
# legend(x=1,y=6,bty='n',col=c('red','blue'),legend=c("Hargreaves","Thornthwaite"),lwd=2,cex=2,y.intersp = 0.75)
summer<-data.frame(Month=month.abb[4:10],Hargreaves=NA,Thornthwaite=NA,Hamon=NA,Pan=NA)
summer$Month<-as.character(summer$Month)
for (i in 1:length(summer$Month)){
subst<-grep(paste0(summer$Month[i],'Harg'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Hargreaves[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'Thorn'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Thornthwaite[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'Ham'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Hamon[i]<-sum(WB@data$AreaRcalc*(subst/1000)*264.1721/1000000000)
subst<-grep(paste0(summer$Month[i],'RefET'),colnames(WB@data))
subst<-WB@data[,subst]
summer$Pan[i]<-sum(WB@data$AreaRcalc*(subst*WB@data$PanCoeff/1000)*264.1721/1000000000)
}
plot(summer$Month,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)')
summer$Month
summer$Hargreaves
plot(summer$Month,summer$Hargreaves)#,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)')
par(mar=c(5,6,2,4),lwd=2,cex.axis=2,cex.lab=2)
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)')
lines(4:10,summer$Thornthwaite,col='dark red')
lines(4:10,summer$Hamon,col='dark blue')
lines(4:10,summer$Pan,col='brown')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)',ylim=c(0,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='brown')
par(mar=c(5,6,2,4),lwd=2,cex.axis=2,cex.lab=2)
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='grey')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='dark grey')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='dark orange')
legend(x=6,y=0.8,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),col=c('black','dark red','dark blue','dark orange'),lty=1,lwd=4,cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.leng=0.8)
legend(x=6,y=0.8,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),col=c('black','dark red','dark blue','dark orange'),lty=1,lwd=4,cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8)
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='dark orange')
legend(x=6,y=0.8,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='dark orange')
legend(x=6,y=1,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
par(mar=c(5,6,2,4),lwd=2,cex.axis=2,cex.lab=2)
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (bgy)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='dark orange')
legend(x=6,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (BGY)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',lwd=4,pch=19,col='dark orange')
legend(x=6,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
legend(x=6,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,pch=19,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
par(mar=c(5,6,2,4),lwd=2,cex.axis=2,cex.lab=2)
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (BGY)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',cex=2,lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',cex=2,lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',cex=2,lwd=4,pch=19,col='dark orange')
legend(x=6,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,pch=19,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
par(mar=c(5,6,2,4),lwd=2,cex.axis=2,cex.lab=2)
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (BGY)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',cex=2,lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',cex=2,lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',cex=2,lwd=4,pch=19,col='dark orange')
legend(x=6.5,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,pch=19,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
legend(x=6.4,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,pch=19,lwd=4,
cex=2,x.intersp = 0.5,y.intersp = 0.5,seg.len=0.8,bty='n')
plot(4:10,summer$Hargreaves,type='o',lwd=4,pch=19,cex=2,xlab='Month',ylab='Evaporation (BGY)',ylim=c(0.25,1.5))
lines(4:10,summer$Thornthwaite,type='o',cex=2,lwd=4,pch=19,col='dark red')
lines(4:10,summer$Hamon,type='o',cex=2,lwd=4,pch=19,col='dark blue')
lines(4:10,summer$Pan,type='o',cex=2,lwd=4,pch=19,col='dark orange')
legend(x=6.4,y=0.9,legend=c("Hargreaves","Thornthwaite","Hamon","Pan"),
col=c('black','dark red','dark blue','dark orange'),lty=1,pch=19,lwd=4,
cex=2,x.intersp = 0.4,y.intersp = 0.5,seg.len=0.8,bty='n')
save.image("G:/My Drive/HARP/impoundment_evap_HARP-2016/EvapData.RData")
save.image("C:/Users/connorb5/Desktop/GitHub/cbp_wsm/evap/EvapData.RData")
